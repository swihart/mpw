<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Marginalized Piecewise Weibull Frailty Models in R • mpw</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Marginalized Piecewise Weibull Frailty Models in R">
<meta name="description" content="Aids in the fitting of marginalized piecewise Weibull frailty models for plotting of distributions, survival, hazards, hazard ratios, and vaccine efficacy curves for different levels of underlying heterogeneity.">
<meta property="og:description" content="Aids in the fitting of marginalized piecewise Weibull frailty models for plotting of distributions, survival, hazards, hazard ratios, and vaccine efficacy curves for different levels of underlying heterogeneity.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">mpw</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/alpha.html">Weibull-Weibull-Positive Stable</a></li>
    <li><a class="dropdown-item" href="articles/beta.html">Burr-Weibull-Gamma</a></li>
    <li><a class="dropdown-item" href="articles/lambda.html">Marginalized-Weibull-Inverse Gaussian</a></li>
    <li><a class="dropdown-item" href="articles/rho.html">Marginalized-Weibull-Two Point  &amp;nbsp; &amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp; &amp;nbsp; (fixed mean 1)</a></li>
    <li><a class="dropdown-item" href="articles/womega.html">Marginalized-Weibull-Two Point (unconstrained mean)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="mpw-marginalized-piecewise-weibull-frailty-models-in-r">mpw: Marginalized Piecewise Weibull Frailty Models in R<a class="anchor" aria-label="anchor" href="#mpw-marginalized-piecewise-weibull-frailty-models-in-r"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of mpw is to facilitate estimating Marginalized Piecewise Weibull Frailty Models in R.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of mpw from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"swihart/mpw"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>There are articles on the package webpage (<a href="https://swihart.github.io/mpw/" class="uri">https://swihart.github.io/mpw/</a>) that work through examples of Marginalized Piecewise Weibull Frailty Models in R. Please consult the following articles:</p>
<ul>
<li><p><a href="https://swihart.github.io/mpw/articles/alpha.html">Weibull-Weibull-Positive Stable</a></p></li>
<li><p><a href="https://swihart.github.io/mpw/articles/beta.html">Burr-Weibull-Gamma</a></p></li>
<li><p><a href="https://swihart.github.io/mpw/articles/lambda.html">Marginalized-Weibull-Inverse Gaussian</a></p></li>
<li><p><a href="https://swihart.github.io/mpw/articles/rho.html">Marginalized-Weibull-Two Point (fixed mean 1)</a></p></li>
<li><p><a href="https://swihart.github.io/mpw/articles/womega.html">Marginalized-Weibull-Two Point (unconstrained mean)</a></p></li>
</ul>
<p>What follows below are basic function calls for one group. The articles above show a work-flow for calculating and plotting population-average and subject-specific hazard ratios (HRs) comparing two groups.</p>
</div>
<div class="section level2">
<h2 id="psalphaalpha0-positive-stable-example">PS(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>α</mi><mo>,</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha,\alpha,0</annotation></semantics></math>) Positive Stable Example<a class="anchor" aria-label="anchor" href="#psalphaalpha0-positive-stable-example"></a>
</h2>
<p>This is the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>α</mi></msub><annotation encoding="application/x-tex">F_{\alpha}</annotation></semantics></math> referenced in the manuscript.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://swihart.github.io/mpw/">mpw</a></span><span class="op">)</span></span>
<span><span class="co">## This data resembles Figure 2 in Thomas et al</span></span>
<span><span class="co">## https://pubmed.ncbi.nlm.nih.gov/34525277/</span></span>
<span><span class="va">time</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span>,<span class="fl">28</span>,<span class="fl">42</span>,<span class="fl">56</span>,<span class="fl">70</span>,<span class="fl">84</span>,<span class="fl">98</span>,<span class="fl">112</span>,<span class="fl">126</span>,<span class="fl">140</span>,<span class="fl">154</span>,<span class="fl">168</span>,<span class="fl">182</span>,<span class="fl">196</span><span class="op">)</span></span>
<span><span class="va">F1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.18</span>,<span class="fl">.19</span>,<span class="fl">.22</span>,<span class="fl">.25</span>,<span class="fl">.27</span>,<span class="fl">.28</span>,<span class="fl">.34</span>,<span class="fl">.44</span>,<span class="fl">.50</span>,<span class="fl">.60</span>,<span class="fl">.72</span>,<span class="fl">.75</span>,<span class="fl">.81</span>,<span class="fl">.93</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="va">F0</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.29</span>,<span class="fl">.60</span>,<span class="fl">1</span>,<span class="fl">1.38</span>,<span class="fl">1.75</span>,<span class="fl">2.25</span>,<span class="fl">2.97</span>,<span class="fl">3.50</span>,<span class="fl">4.25</span>,<span class="fl">4.94</span>,<span class="fl">5.53</span>,<span class="fl">6.00</span>,<span class="fl">6.31</span>,<span class="fl">6.94</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span></span>
<span><span class="va">tvec.in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">14</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">-</span><span class="fl">14</span>,length.out<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">-</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">init.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2.4</span><span class="op">)</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tvec.in</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## fit F_alpha for a given H_PARM</span></span>
<span><span class="va">H_PARM</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span>
<span><span class="va">fit_F_alpha</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="reference/popavg_dist.html">popavg_dist</a></span><span class="op">(</span><span class="va">time</span>, </span>
<span>                                            knots<span class="op">=</span> <span class="va">tvec.in</span>, </span>
<span>                                            logk0<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                                            g0<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>                                            delta_vec<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                            h_parm <span class="op">=</span> <span class="va">H_PARM</span>,</span>
<span>                                            frailty<span class="op">=</span><span class="st">"PS"</span><span class="op">)</span>  <span class="op">-</span> <span class="va">F0</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">plac_fit_F_alpha</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">init.vals</span>, <span class="va">fit_F_alpha</span>,</span>
<span>        method<span class="op">=</span><span class="st">"Nelder-Mead"</span>,</span>
<span>        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">1e8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plac_fit_F_alpha</span><span class="op">)</span></span>
<span><span class="co">#&gt; $par</span></span>
<span><span class="co">#&gt;  [1]  -0.15799938 -10.12040145  -0.21508909   0.74768428   0.21589618</span></span>
<span><span class="co">#&gt;  [6]   0.03136962  -0.15528469   0.27388947   0.35359469   0.20431276</span></span>
<span><span class="co">#&gt; [11]  -0.03848921  -0.39518830   0.11877485  -0.05979150  -0.91393283</span></span>
<span><span class="co">#&gt; [16]  -0.27749430   0.54807831   1.84013113</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 1.831274e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $counts</span></span>
<span><span class="co">#&gt; function gradient </span></span>
<span><span class="co">#&gt;     1239       NA </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $message</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="va">logk0p</span> <span class="op">=</span> <span class="va">plac_fit_F_alpha</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">g0p</span> <span class="op">=</span> <span class="va">plac_fit_F_alpha</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">delta_vec_p</span> <span class="op">=</span><span class="va">plac_fit_F_alpha</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>, </span>
<span>     <span class="fu"><a href="reference/popavg_dist.html">popavg_dist</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>, </span>
<span>                 delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span>, h_parm<span class="op">=</span> <span class="va">H_PARM</span>, frailty<span class="op">=</span><span class="st">"PS"</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">F0</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_alpha-1.png" width="100%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## plot the pop-avg (marginal) hazard:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>     <span class="fu"><a href="reference/popavg_haz.html">popavg_haz</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>,</span>
<span>                  delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span>, h_parm<span class="op">=</span> <span class="va">H_PARM</span>,</span>
<span>                                            frailty<span class="op">=</span><span class="st">"PS"</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"l"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot the subject-specific hazard, fit in the presence</span></span>
<span><span class="co">## of the h_parm value:</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>     <span class="fu"><a href="reference/subjspec_haz.html">subjspec_haz</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>,</span>
<span>                  delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span><span class="op">)</span>,</span>
<span>     lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_alpha-2.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="gammabetabeta-example">Gamma(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>,</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta,\beta</annotation></semantics></math>) Example<a class="anchor" aria-label="anchor" href="#gammabetabeta-example"></a>
</h2>
<p>This is the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>β</mi></msub><annotation encoding="application/x-tex">F_{\beta}</annotation></semantics></math> referenced in the manuscript.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://swihart.github.io/mpw/">mpw</a></span><span class="op">)</span></span>
<span><span class="co">## This data resembles Figure 2 in Thomas et al</span></span>
<span><span class="co">## https://pubmed.ncbi.nlm.nih.gov/34525277/</span></span>
<span><span class="va">time</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span>,<span class="fl">28</span>,<span class="fl">42</span>,<span class="fl">56</span>,<span class="fl">70</span>,<span class="fl">84</span>,<span class="fl">98</span>,<span class="fl">112</span>,<span class="fl">126</span>,<span class="fl">140</span>,<span class="fl">154</span>,<span class="fl">168</span>,<span class="fl">182</span>,<span class="fl">196</span><span class="op">)</span></span>
<span><span class="va">F1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.18</span>,<span class="fl">.19</span>,<span class="fl">.22</span>,<span class="fl">.25</span>,<span class="fl">.27</span>,<span class="fl">.28</span>,<span class="fl">.34</span>,<span class="fl">.44</span>,<span class="fl">.50</span>,<span class="fl">.60</span>,<span class="fl">.72</span>,<span class="fl">.75</span>,<span class="fl">.81</span>,<span class="fl">.93</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="va">F0</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.29</span>,<span class="fl">.60</span>,<span class="fl">1</span>,<span class="fl">1.38</span>,<span class="fl">1.75</span>,<span class="fl">2.25</span>,<span class="fl">2.97</span>,<span class="fl">3.50</span>,<span class="fl">4.25</span>,<span class="fl">4.94</span>,<span class="fl">5.53</span>,<span class="fl">6.00</span>,<span class="fl">6.31</span>,<span class="fl">6.94</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span></span>
<span><span class="va">tvec.in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">14</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">-</span><span class="fl">14</span>,length.out<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">-</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">init.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2.4</span><span class="op">)</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tvec.in</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## fit F_beta for a given H_PARM</span></span>
<span><span class="va">H_PARM</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span>
<span><span class="va">fit_F_beta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="reference/popavg_dist.html">popavg_dist</a></span><span class="op">(</span><span class="va">time</span>, </span>
<span>                                            knots<span class="op">=</span> <span class="va">tvec.in</span>, </span>
<span>                                            logk0<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                                            g0<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>                                            delta_vec<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                            h_parm <span class="op">=</span> <span class="va">H_PARM</span>,</span>
<span>                                            frailty<span class="op">=</span><span class="st">"GA"</span><span class="op">)</span>  <span class="op">-</span> <span class="va">F0</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">plac_fit_F_beta</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">init.vals</span>, <span class="va">fit_F_beta</span>,</span>
<span>        method<span class="op">=</span><span class="st">"Nelder-Mead"</span>,</span>
<span>        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">1e8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plac_fit_F_beta</span><span class="op">)</span></span>
<span><span class="co">#&gt; $par</span></span>
<span><span class="co">#&gt;  [1]   0.502079930 -10.040468476  -0.330061562   0.003865048  -0.336826948</span></span>
<span><span class="co">#&gt;  [6]  -0.024383734   0.250173132   0.439016976  -0.255277225  -0.234803012</span></span>
<span><span class="co">#&gt; [11]   1.061206688  -0.896795452   0.105126011  -0.138730813  -0.307526058</span></span>
<span><span class="co">#&gt; [16]  -0.739420915   1.018565747   1.429820594</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 4.750979e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $counts</span></span>
<span><span class="co">#&gt; function gradient </span></span>
<span><span class="co">#&gt;      999       NA </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $message</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="va">logk0p</span> <span class="op">=</span> <span class="va">plac_fit_F_beta</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">g0p</span> <span class="op">=</span> <span class="va">plac_fit_F_beta</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">delta_vec_p</span> <span class="op">=</span><span class="va">plac_fit_F_beta</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>, </span>
<span>     <span class="fu"><a href="reference/popavg_dist.html">popavg_dist</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>, </span>
<span>                 delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span>, h_parm<span class="op">=</span><span class="va">H_PARM</span>, frailty<span class="op">=</span><span class="st">"GA"</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">F0</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_beta-1.png" width="100%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## plot the pop-avg (marginal) hazard:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>     <span class="fu"><a href="reference/popavg_haz.html">popavg_haz</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>,</span>
<span>                  delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span>, h_parm<span class="op">=</span> <span class="va">H_PARM</span>, frailty<span class="op">=</span><span class="st">"GA"</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"l"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot the subject-specific hazard, fit in the presence</span></span>
<span><span class="co">## of the h_parm value:</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>     <span class="fu"><a href="reference/subjspec_haz.html">subjspec_haz</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>,</span>
<span>                  delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span><span class="op">)</span>,</span>
<span>     lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_beta-2.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="inverse-gaussian1lambda-example">Inverse Gaussian(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>,</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">1,\lambda</annotation></semantics></math>) Example<a class="anchor" aria-label="anchor" href="#inverse-gaussian1lambda-example"></a>
</h2>
<p>This is the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>λ</mi></msub><annotation encoding="application/x-tex">F_{\lambda}</annotation></semantics></math> referenced in the manuscript.</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>λ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mfrac><mn>2</mn><mi>λ</mi></mfrac><mo>exp</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">F_{\lambda}(x) = 1-\exp[- \lambda ( (1+ \frac{2}{\lambda} \exp\eta )^{\frac{1}{2}} - 1) ]</annotation></semantics></math></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://swihart.github.io/mpw/">mpw</a></span><span class="op">)</span></span>
<span><span class="co">## This data resembles Figure 2 in Thomas et al</span></span>
<span><span class="co">## https://pubmed.ncbi.nlm.nih.gov/34525277/</span></span>
<span><span class="va">time</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span>,<span class="fl">28</span>,<span class="fl">42</span>,<span class="fl">56</span>,<span class="fl">70</span>,<span class="fl">84</span>,<span class="fl">98</span>,<span class="fl">112</span>,<span class="fl">126</span>,<span class="fl">140</span>,<span class="fl">154</span>,<span class="fl">168</span>,<span class="fl">182</span>,<span class="fl">196</span><span class="op">)</span></span>
<span><span class="va">F1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.18</span>,<span class="fl">.19</span>,<span class="fl">.22</span>,<span class="fl">.25</span>,<span class="fl">.27</span>,<span class="fl">.28</span>,<span class="fl">.34</span>,<span class="fl">.44</span>,<span class="fl">.50</span>,<span class="fl">.60</span>,<span class="fl">.72</span>,<span class="fl">.75</span>,<span class="fl">.81</span>,<span class="fl">.93</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="va">F0</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.29</span>,<span class="fl">.60</span>,<span class="fl">1</span>,<span class="fl">1.38</span>,<span class="fl">1.75</span>,<span class="fl">2.25</span>,<span class="fl">2.97</span>,<span class="fl">3.50</span>,<span class="fl">4.25</span>,<span class="fl">4.94</span>,<span class="fl">5.53</span>,<span class="fl">6.00</span>,<span class="fl">6.31</span>,<span class="fl">6.94</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span></span>
<span><span class="va">tvec.in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">14</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">-</span><span class="fl">14</span>,length.out<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">-</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">init.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2.4</span><span class="op">)</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tvec.in</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## fit F_lambda for a given H_PARM</span></span>
<span><span class="va">H_PARM</span> <span class="op">&lt;-</span> <span class="fl">0.72</span></span>
<span><span class="va">fit_F_lambda</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="reference/popavg_dist.html">popavg_dist</a></span><span class="op">(</span><span class="va">time</span>, </span>
<span>                                            knots<span class="op">=</span> <span class="va">tvec.in</span>, </span>
<span>                                            logk0<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                                            g0<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>                                            delta_vec<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                            h_parm <span class="op">=</span> <span class="va">H_PARM</span>,</span>
<span>                                            frailty<span class="op">=</span><span class="st">"IG"</span><span class="op">)</span>  <span class="op">-</span> <span class="va">F0</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">plac_fit_F_lambda</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">init.vals</span>, <span class="va">fit_F_lambda</span>,</span>
<span>        method<span class="op">=</span><span class="st">"Nelder-Mead"</span>,</span>
<span>        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">1e8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plac_fit_F_lambda</span><span class="op">)</span></span>
<span><span class="co">#&gt; $par</span></span>
<span><span class="co">#&gt;  [1]  0.519049948 -9.963880564 -0.548971978  0.009675958  0.114421179</span></span>
<span><span class="co">#&gt;  [6] -0.167680517  0.032601213  0.688049475 -0.746732555  0.412303893</span></span>
<span><span class="co">#&gt; [11]  0.728639433 -1.136741731  0.565512220 -0.328530329 -0.491673765</span></span>
<span><span class="co">#&gt; [16] -0.139534288  0.275973154  1.104640530</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 2.955449e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $counts</span></span>
<span><span class="co">#&gt; function gradient </span></span>
<span><span class="co">#&gt;     1225       NA </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $message</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="va">logk0p</span> <span class="op">=</span> <span class="va">plac_fit_F_lambda</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">g0p</span> <span class="op">=</span> <span class="va">plac_fit_F_lambda</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">delta_vec_p</span> <span class="op">=</span><span class="va">plac_fit_F_lambda</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>, </span>
<span>     <span class="fu"><a href="reference/popavg_dist.html">popavg_dist</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>, </span>
<span>                 delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span>, h_parm<span class="op">=</span><span class="va">H_PARM</span>, frailty<span class="op">=</span><span class="st">"IG"</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">F0</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_lambda-1.png" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## plot the pop-avg (marginal) hazard:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>     <span class="fu"><a href="reference/popavg_haz.html">popavg_haz</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>,</span>
<span>                  delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span>, h_parm<span class="op">=</span><span class="va">H_PARM</span>, frailty<span class="op">=</span><span class="st">"IG"</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"l"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot the subject-specific hazard, fit in the presence</span></span>
<span><span class="co">## of the h_parm value:</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>     <span class="fu"><a href="reference/subjspec_haz.html">subjspec_haz</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>,</span>
<span>                  delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span><span class="op">)</span>,</span>
<span>     lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_lambda-2.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="two-pointrho-xi-example">Two-Point(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>) Example<a class="anchor" aria-label="anchor" href="#two-pointrho-xi-example"></a>
</h2>
<p>This is the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>ρ</mi></msub><annotation encoding="application/x-tex">F_{\rho}</annotation></semantics></math> referenced in the manuscript.</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>ρ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mi>ξ</mi><mo>exp</mo><mi>η</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mi>ρ</mi><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><msup><mi>ξ</mi><mi>′</mi></msup><mo>exp</mo><mi>η</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_{\rho}(x) =  1-             \left(           (1-\rho)  \exp[- \xi \exp\eta ] + \rho \exp[-\xi^{\prime} \exp \eta ] \right)</annotation></semantics></math></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://swihart.github.io/mpw/">mpw</a></span><span class="op">)</span></span>
<span><span class="co">## This data resembles Figure 2 in Thomas et al</span></span>
<span><span class="co">## https://pubmed.ncbi.nlm.nih.gov/34525277/</span></span>
<span><span class="va">time</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span>,<span class="fl">28</span>,<span class="fl">42</span>,<span class="fl">56</span>,<span class="fl">70</span>,<span class="fl">84</span>,<span class="fl">98</span>,<span class="fl">112</span>,<span class="fl">126</span>,<span class="fl">140</span>,<span class="fl">154</span>,<span class="fl">168</span>,<span class="fl">182</span>,<span class="fl">196</span><span class="op">)</span></span>
<span><span class="va">F1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.18</span>,<span class="fl">.19</span>,<span class="fl">.22</span>,<span class="fl">.25</span>,<span class="fl">.27</span>,<span class="fl">.28</span>,<span class="fl">.34</span>,<span class="fl">.44</span>,<span class="fl">.50</span>,<span class="fl">.60</span>,<span class="fl">.72</span>,<span class="fl">.75</span>,<span class="fl">.81</span>,<span class="fl">.93</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="va">F0</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.29</span>,<span class="fl">.60</span>,<span class="fl">1</span>,<span class="fl">1.38</span>,<span class="fl">1.75</span>,<span class="fl">2.25</span>,<span class="fl">2.97</span>,<span class="fl">3.50</span>,<span class="fl">4.25</span>,<span class="fl">4.94</span>,<span class="fl">5.53</span>,<span class="fl">6.00</span>,<span class="fl">6.31</span>,<span class="fl">6.94</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span></span>
<span><span class="va">tvec.in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">14</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">-</span><span class="fl">14</span>,length.out<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">-</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">init.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2.4</span><span class="op">)</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tvec.in</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## fit F_rho for a given H_PARM and XI &lt;1</span></span>
<span><span class="co">## (1-H_PARM) will have value XI &lt; 1</span></span>
<span><span class="co">##    H_PARM  will have XI_prime &gt; 1 that ensures E[u] = 1</span></span>
<span><span class="va">H_PARM</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">XI</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="va">fit_F_rho</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="reference/popavg_dist.html">popavg_dist</a></span><span class="op">(</span><span class="va">time</span>, </span>
<span>                                            knots<span class="op">=</span> <span class="va">tvec.in</span>, </span>
<span>                                            logk0<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                                            g0<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>                                            delta_vec<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                            h_parm <span class="op">=</span> <span class="va">H_PARM</span>,</span>
<span>                                            frailty<span class="op">=</span><span class="st">"TP1"</span>,</span>
<span>                                            xi <span class="op">=</span> <span class="va">XI</span><span class="op">)</span>  <span class="op">-</span> <span class="va">F0</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">plac_fit_F_rho</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">init.vals</span>, <span class="va">fit_F_rho</span>,</span>
<span>        method<span class="op">=</span><span class="st">"Nelder-Mead"</span>,</span>
<span>        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">1e8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plac_fit_F_rho</span><span class="op">)</span></span>
<span><span class="co">#&gt; $par</span></span>
<span><span class="co">#&gt;  [1]  0.504788613 -9.907296470 -0.306067147 -0.209186119 -0.145926847</span></span>
<span><span class="co">#&gt;  [6] -0.254946042  0.822243872  0.007185863  0.087754729  0.002753200</span></span>
<span><span class="co">#&gt; [11]  0.214539410  0.111070205 -0.516003004  0.469736272 -1.126555327</span></span>
<span><span class="co">#&gt; [16]  0.332635368  0.617509128  0.509920955</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 2.793263e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $counts</span></span>
<span><span class="co">#&gt; function gradient </span></span>
<span><span class="co">#&gt;     1111       NA </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $message</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="va">logk0p</span> <span class="op">=</span> <span class="va">plac_fit_F_rho</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">g0p</span> <span class="op">=</span> <span class="va">plac_fit_F_rho</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">delta_vec_p</span> <span class="op">=</span><span class="va">plac_fit_F_rho</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>, </span>
<span>     <span class="fu"><a href="reference/popavg_dist.html">popavg_dist</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>, </span>
<span>                 delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span>, h_parm<span class="op">=</span><span class="va">H_PARM</span>, </span>
<span>                 frailty<span class="op">=</span><span class="st">"TP1"</span>, xi <span class="op">=</span> <span class="va">XI</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">F0</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_rho-1.png" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## plot the pop-avg (marginal) hazard:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>     <span class="fu"><a href="reference/popavg_haz.html">popavg_haz</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>,</span>
<span>                  delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span>, h_parm<span class="op">=</span><span class="va">H_PARM</span>, </span>
<span>                frailty<span class="op">=</span><span class="st">"TP1"</span>, xi<span class="op">=</span><span class="va">XI</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"l"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot the subject-specific hazard, fit in the presence</span></span>
<span><span class="co">## of the h_parm value:</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>     <span class="fu"><a href="reference/subjspec_haz.html">subjspec_haz</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>,</span>
<span>                  delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span><span class="op">)</span>,</span>
<span>     lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_rho-2.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="two-pointomega-n-s-example">Two-Point(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ω</mi><annotation encoding="application/x-tex">\omega</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>) Example<a class="anchor" aria-label="anchor" href="#two-pointomega-n-s-example"></a>
</h2>
<p>This is the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>ω</mi></msub><annotation encoding="application/x-tex">F_{\omega}</annotation></semantics></math> referenced in the manuscript.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://swihart.github.io/mpw/">mpw</a></span><span class="op">)</span></span>
<span><span class="co">## This data resembles Figure 2 in Thomas et al</span></span>
<span><span class="co">## https://pubmed.ncbi.nlm.nih.gov/34525277/</span></span>
<span><span class="va">time</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span>,<span class="fl">28</span>,<span class="fl">42</span>,<span class="fl">56</span>,<span class="fl">70</span>,<span class="fl">84</span>,<span class="fl">98</span>,<span class="fl">112</span>,<span class="fl">126</span>,<span class="fl">140</span>,<span class="fl">154</span>,<span class="fl">168</span>,<span class="fl">182</span>,<span class="fl">196</span><span class="op">)</span></span>
<span><span class="va">F1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.18</span>,<span class="fl">.19</span>,<span class="fl">.22</span>,<span class="fl">.25</span>,<span class="fl">.27</span>,<span class="fl">.28</span>,<span class="fl">.34</span>,<span class="fl">.44</span>,<span class="fl">.50</span>,<span class="fl">.60</span>,<span class="fl">.72</span>,<span class="fl">.75</span>,<span class="fl">.81</span>,<span class="fl">.93</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="va">F0</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.29</span>,<span class="fl">.60</span>,<span class="fl">1</span>,<span class="fl">1.38</span>,<span class="fl">1.75</span>,<span class="fl">2.25</span>,<span class="fl">2.97</span>,<span class="fl">3.50</span>,<span class="fl">4.25</span>,<span class="fl">4.94</span>,<span class="fl">5.53</span>,<span class="fl">6.00</span>,<span class="fl">6.31</span>,<span class="fl">6.94</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span></span>
<span><span class="va">tvec.in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">14</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">-</span><span class="fl">14</span>,length.out<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">-</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">init.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2.4</span><span class="op">)</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tvec.in</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## fit F_omega for a given H_PARM and N&lt;1 and S&gt;1</span></span>
<span><span class="co">## (1-H_PARM) will have value N &lt; 1</span></span>
<span><span class="co">##    H_PARM  will have value S &gt; 1 </span></span>
<span><span class="va">H_PARM</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">4.00</span></span>
<span><span class="va">fit_F_omega</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="reference/popavg_dist.html">popavg_dist</a></span><span class="op">(</span><span class="va">time</span>, </span>
<span>                                            knots<span class="op">=</span> <span class="va">tvec.in</span>, </span>
<span>                                            logk0<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                                            g0<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>                                            delta_vec<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                            h_parm <span class="op">=</span> <span class="va">H_PARM</span>,</span>
<span>                                            frailty<span class="op">=</span><span class="st">"TPU"</span>,</span>
<span>                                            n<span class="op">=</span><span class="va">N</span>,</span>
<span>                                            s<span class="op">=</span><span class="va">S</span><span class="op">)</span>  <span class="op">-</span> <span class="va">F0</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">plac_fit_F_omega</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">init.vals</span>, <span class="va">fit_F_omega</span>,</span>
<span>        method<span class="op">=</span><span class="st">"Nelder-Mead"</span>,</span>
<span>        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">1e8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plac_fit_F_omega</span><span class="op">)</span></span>
<span><span class="co">#&gt; $par</span></span>
<span><span class="co">#&gt;  [1]  0.48099077 -9.97182403 -0.91909126  0.05937541  0.33699959 -0.01413072</span></span>
<span><span class="co">#&gt;  [7] -0.17026103  0.81246434 -0.14277889 -0.04705732  0.03813736 -0.45175104</span></span>
<span><span class="co">#&gt; [13]  1.01934966 -1.27666904  0.08861910 -0.51736433  0.95470678  0.83804581</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 3.751629e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $counts</span></span>
<span><span class="co">#&gt; function gradient </span></span>
<span><span class="co">#&gt;     1035       NA </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $message</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="va">logk0p</span> <span class="op">=</span> <span class="va">plac_fit_F_omega</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">g0p</span> <span class="op">=</span> <span class="va">plac_fit_F_omega</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">delta_vec_p</span> <span class="op">=</span><span class="va">plac_fit_F_omega</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>, </span>
<span>     <span class="fu"><a href="reference/popavg_dist.html">popavg_dist</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>, </span>
<span>                 delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span>, h_parm<span class="op">=</span><span class="va">H_PARM</span>, frailty<span class="op">=</span><span class="st">"TPU"</span>,</span>
<span>                 n<span class="op">=</span><span class="va">N</span>, s<span class="op">=</span><span class="va">S</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">F0</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_omega-1.png" width="100%"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## plot the pop-avg (marginal) hazard:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>     <span class="fu"><a href="reference/popavg_haz.html">popavg_haz</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>,</span>
<span>                  delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span>, h_parm<span class="op">=</span><span class="va">H_PARM</span>, </span>
<span>                frailty<span class="op">=</span><span class="st">"TPU"</span>, n<span class="op">=</span><span class="fl">0.25</span>, s<span class="op">=</span><span class="fl">4.00</span><span class="op">)</span>,</span>
<span>     type<span class="op">=</span><span class="st">"l"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot the subject-specific hazard, fit in the presence</span></span>
<span><span class="co">## of the h_parm value:</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>     <span class="fu"><a href="reference/subjspec_haz.html">subjspec_haz</a></span><span class="op">(</span><span class="va">time</span>, knots<span class="op">=</span><span class="va">tvec.in</span>, logk0<span class="op">=</span><span class="va">logk0p</span>, g0<span class="op">=</span><span class="va">g0p</span>,</span>
<span>                  delta_vec <span class="op">=</span> <span class="va">delta_vec_p</span><span class="op">)</span>,</span>
<span>     lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_omega-2.png" width="100%"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>LGPL (&gt;= 2.1)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mpw</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Bruce Swihart <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4216-9942" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bruce Swihart.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
